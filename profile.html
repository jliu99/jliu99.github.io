<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Sample Profile</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link href='https://fonts.googleapis.com/css?family=Maven+Pro:700' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="js/d3/d3.js"></script>
    <script type="text/javascript" src="js/jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="js/signature-module.js"></script>
</head>

<body>
    <div id="loading">
        <h3>loading...</h3>
    </div>
    <header>
        <h2><a href="index.html">Research Analytics Institutional Lookup</a></h2>
    </header>
    <main>
        <section id="profile">
            <div id="icon">
                <img src="img/placeholder.png" />
            </div>
            <div id="info">
                <h2 id="name"></h2>
                <p>Institution: University of Chicago
                    <br>Email: johndoe@uchicago.edu</p>
            </div>
            <div id="numbers">
                <p>h-Index</p>
                <a class="tooltip" href="#" title="Index number here">
                    <div id="index-graph-container">
                        <svg class="svg" id="index-svg">
                            <rect x="0" y="0" height="100%" width="60%" fill="#971E1E" />
                        </svg>
                    </div>
                </a>
                <h2 class="count" id="a-count"></h2>
                <p>Articles represented</p>
            </div>
        </section>
        <section id="display-toggles">
            <ul>
                <li class="selected" onclick="handleTabs(this)">Signature</li>
                <li onclick="handleTabs(this)">Co-authors</li>
                <li onclick="handleTabs(this)">Published Works</li>
            </ul>
        </section>
        <section id="display">
            <svg id="main-svg" class="svg">
            </svg>
        </section>
        <section id="related">
            <h4>related profiles</h4>
            <hr />
            <ul>
                <li>
                    <a href="">
                        <svg class="svg rel-prof" id="rel1">
                        </svg>
                        <p>Jane Doe</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <svg class="svg rel-prof" id="rel2"></svg>
                        <p>Gary Sue</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <svg class="svg rel-prof" id="rel3"></svg>
                        <p>Mary Sue</p>
                    </a>
                </li>
                <li>
                    <a href="">
                        <svg class="svg rel-prof" id="rel4"></svg>
                        <p>Bob Jones</p>
                    </a>
                </li>
            </ul>
        </section>
    </main>
    <footer>
        <div id="footer-img-wrapper">
            <div class="footer-img">
                <a href="http://www.uchicago.edu/"><img src="img/University_of_Chicago_logo.png" /></a>
            </div>
            <div class="footer-img">
                <a href="http://www.knowledgelab.org/"><img src="img/KnowledgeLab.Main.Black.png" /></a>
            </div>
        </div>
    </footer>
    
    <script type="text/javascript">
        //Variables
        var author, numTopics;
        var name, id, topics, pubCount;
        var topicNames = [],
            topicScores = [],
            topicsList = [];

        //Load in JSON and initialize variables + page content
        d3.json("/data/all_data_new.json", function (data) {
            var r = Math.floor(Math.random() * data.length);
            author = data[r];
            name = capitalizeLetters(author.authorName);
            id = author.ID;
            topics = author.topics;
            numTopics = topics.length;
            pubCount = author.pubCount;
            document.getElementById("name").innerHTML = name;
            document.getElementById("a-count").innerHTML = pubCount;

            //Animates the article count numbers
            $('.count').each(function () {
                $(this).prop('Counter', 0).animate({
                    Counter: $(this).text()
                }, {
                    duration: 2000,
                    easing: 'swing',
                    step: function (now) {
                        $(this).text(Math.ceil(now));
                    }
                });
            });

            for (i = 0; i < numTopics; i++) {
                var n = topics[i][1]["names"][0];
                topicNames.push(capitalizeLetters(n));
                topicScores.push(topics[i][1]["score"]);
            }
            setMax(d3.max(topicScores));
            setTopResultsNumber(10);
            loadData(topicScores);
            loadNames(topicNames);
            var loadDiv = document.getElementById("loading");
            loadDiv.style.left = "-100vw";
            loadDiv.style.display = "none";
            loadDiv.style.transition = "left 1000ms";
            loadDiv.style.transition = "display 1000ms 4ms";

            createSignature("main-svg");
        });
    </script>
    <script type="text/javascript">
        jQuery.fn.sbTooltip = function () {

            // For each instance of this element
            return this.each(function () {

                // Add the new attribute with title's current value and then remove the title attribute
                jQuery(this).attr({
                    'data-sbtooltip': jQuery(this).attr("title")
                }).removeAttr("title");

            });

        };

        $(document).ready(function () {
            $(".tooltip").sbTooltip();
        });

        var h = d3.select("#a-count");
        h.attr("style", "opacity:0;");
        h.transition()
            .duration(1000)
            .attr("style", "opacity:1");

        d3.select("#numbers").selectAll("p").style("opacity", "0.5");
        d3.select("#numbers").selectAll("p").transition()
            .duration(250)
            .style("opacity", "1");
        d3.select("#index-graph-container").style("opacity", "0.5");
        d3.select("#index-graph-container").transition()
            .duration(2000)
            .style("opacity", "1");

        var r = d3.select("#index-svg").select("rect");
        var w = r.attr("width");
        r.attr("width", "0")
            .attr("opacity", "0.6");
        r.transition()
            .duration(1250)
            .attr("width", w)
            .attr("opacity", "1");

        d3.select("#info").select("p").transition()
            .duration(800)
            .style("opacity", "1");
    </script>
    <script type="text/javascript">
        for (j = 1; j <= 4; j++) {
            var dataArray = [];
            for (i = 0; i < 150; i++) {
                var data = Math.floor(101 * Math.random());
                dataArray.push(data);
            }
            loadData(dataArray);
            setMax(d3.max(dataArray));
            createStagnantSignature("rel" + j);
        }
    </script>
    <script type="text/javascript">
        function clearSVG(){
            d3.select("#main-svg").selectAll("*").remove();
        }
        function handleTabs(){
            clearSVG();
        }
    </script>
</body>

</html>